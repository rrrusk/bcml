#!/usr/bin/env ruby

THIS_FILE = File.symlink?(__FILE__) ? File.readlink(__FILE__) : __FILE__
$MY_DIRECTORY = File.dirname(THIS_FILE) + '/..'
begin
  require File.dirname(THIS_FILE) + '/../lib/bcml'
rescue LoadError
  require 'bcml'
end

path = ARGV[0].gsub(/(?<=\/).+(?!\/)/,"") if ARGV[0] =~ /\//
newfile = open("#{path}convert.html", 'w')
source = open(ARGV[0])
contents = source.read
source.close

bcml = Bcml.new
converted = bcml.exec(contents)

newfile.write(converted)
newfile.close
